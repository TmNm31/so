<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>ë™ë„¤ í•œë°”í€´</title>

  <!-- âœ… PWA ë©”íƒ€ íƒœê·¸ -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#007BFF" />
  <link rel="apple-touch-icon" href="icon-192.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />

  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      background: #f4f4f4;
      max-width: 1080px;
      margin: 0 auto;
    }
    .page {
      display: none;
      padding: 16px;
    }
    .page.active {
      display: block;
    }
    .card {
      background: white;
      padding: 16px;
      margin-bottom: 16px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    .button {
      background: #007BFF;
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      margin-top: 10px;
    }
    .footer {
      text-align: center;
      padding: 20px;
      font-size: 0.9em;
      color: #777;
    }
    .seat-container {
      display: grid;
      grid-template-columns: repeat(10, 1fr);
      gap: 1px;
      justify-items: center;
    }
    .seat {
      width: 22px;
      height: 22px;
      border-radius: 4px;
      text-align: center;
      line-height: 22px;
      color: white;
    }
    select, input {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .banner {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #ddd;
      padding: 10px;
      text-align: center;
      font-size: 0.9em;
    }
    .favorite {
      color: gold;
      font-size: 1.2em;
      cursor: pointer;
      float: right;
    }
    #statusView h2 {
      text-align: center;
    }
    .message {
      color: red;
      font-weight: bold;
      text-align: center;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div id="main" class="page active">
    <h2 style="text-align: center;">ë™ë„¤ í•œë°”í€´</h2>
    <div class="card"><div class="button" onclick="goTo('busSearch')">ë²„ìŠ¤ í˜¼ì¡ë„ ë³´ê¸°</div></div>
    <div class="card">
      <h3>ì†Œì‹</h3>
        <li>ğŸŸ¢ ê¸°í›„ë™í–‰ì¹´ë“œ ì œëŒ€êµ°ì¸ ì²­ë…„í• ì¸ ì—°ì¥, ì˜¨ë¼ì¸ìœ¼ë¡œ í¸ë¦¬í•˜ê²Œ ì‹ ì²­í•˜ì„¸ìš”!</li>
        <li>ğŸšŒ ë²„ìŠ¤ ìš°íšŒ ë° ë§‰ì°¨ì‹œê°„ ì—°ì¥ ì•ˆë‚´</li>
    </div>
    <div class="card">ë²„ìŠ¤ ì •ë³´</div>
  </div>

  <div id="busSearch" class="page">
    <h2 style="text-align: center;">ë²„ìŠ¤ ê²€ìƒ‰</h2>
    <input type="text" id="busNumber" placeholder="ë²„ìŠ¤ ë²ˆí˜¸ ì…ë ¥" />
    <div class="button" onclick="searchBus()">ê²€ìƒ‰</div>
    <div id="searchMessage" class="message"></div>
    <div class="button" onclick="goTo('main')">ë’¤ë¡œ</div>
  </div>

  <div id="routeView" class="page">
    <h2 id="routeTitle"></h2>
    <div>
      <label>íƒ‘ìŠ¹ ì •ê±°ì¥:</label>
      <select id="boardStation"></select>
      <label>í•˜ì°¨ ì •ê±°ì¥:</label>
      <select id="dropStation"></select>
    </div>
    <div>
      <span class="favorite" onclick="toggleFavorite()" id="favoriteStar">â˜†</span>
    </div>
    <div class="button" onclick="goTo('statusView'); generateSeats()">íƒ‘ìŠ¹ í˜„í™© ë³´ê¸°</div>
    <div class="button" onclick="goTo('busSearch')">ë‹¤ì‹œ ê²€ìƒ‰</div>
  </div>

  <div id="statusView" class="page">
    <h2 style="text-align: center;">ë²„ìŠ¤ ì¢Œì„ í˜„í™©</h2>
    <div class="seat-container" id="seatMap"></div>
    <div id="etaInfo" style="margin-top: 16px; font-size: 1.2em; color: #007BFF; text-align: center;"></div>
    <div id="congestionLevel" style="margin-top: 16px; font-size: 1.2em; font-weight: bold; text-align: center;"></div>
    <div class="button" onclick="goTo('routeView')">ë’¤ë¡œ</div>
    <div class="button" onclick="goTo('main')">í™ˆìœ¼ë¡œ</div>
  </div>

  <div class="banner">ê´‘ê³  ë°°ë„ˆ ì˜ì—­</div>

  <script>
    let isFavorite = false;

    const routes = {
        "1": ["ë°˜ì„±í„°ë¯¸ë„", "ì‹œì •", "ì§„ì£¼ì™¸êµ­ì–´ê³ ë“±í•™êµ/ë°˜ì„±ì‹œì¥", "êµ¬ë¦¬/ë°˜ì„±ì‹œì¥", "ë°˜ì„±ì´ˆë“±í•™êµ/ë‚¨í‰", "ê°œì•”", "ê²½ìƒë‚¨ë„ìˆ˜ëª©ì›", "ì˜¤ë™ì…êµ¬", "ëŒ€ì²œ", "ì´ë°˜ì„±êµì°¨ë¡œ", "ìƒì´Œ/ì¤‘ì´Œ", "ëª¨ê³¡", "ì´ë°˜ì„±ë©´ì‚¬ë¬´ì†Œ", "ì´ë°˜ì„±ì´ˆë“±í•™êµ", "ì‚¼ê±°", "í‰ì´ŒêµíšŒ", "ì¤‘ë„", "ê²€ì •ì‚¬ê±°ë¦¬", "ê²€ì •", "ì¥ì•ˆ", "ì§„ì•ˆ", "ìƒˆë°­ê³¨", "ë™ì´Œ", "ì„œì´Œ", "ì„œì´Œê²½ë¡œë‹¹", "ì´ë°˜ì„±ë³´ê±´ì†Œì§€ì†Œ", "ì´ë°˜ì„±ë©´ì‚¬ë¬´ì†Œ", "ëª¨ê³¡", "ìƒì´Œ/ì¤‘ì´Œ", "ì´ë°˜ì„±êµì°¨ë¡œ", "ëŒ€ì²œ", "ê²½ìƒë‚¨ë„ìˆ˜ëª©ì›", "ê°œì•”", "ë°˜ì„±ì´ˆë“±í•™êµ/ë‚¨í‰", "êµ¬ë¦¬/ë°˜ì„±ì‹œì¥", "ì§„ì£¼ì™¸êµ­ì–´ê³ ë“±í•™êµ/ë°˜ì„±ì‹œì¥", "ì‹œì •", "ì¼ë°˜ì„±ë©´ì‚¬ë¬´ì†Œ", "ë°˜ì„±í„°ë¯¸ë„"],
      "2": ["ë°˜ì„±í„°ë¯¸ë„", "ìˆ˜ëª©ì› ë°©ë©´ì‹œì •", "ìˆ˜ëª©ì› ë°©ë©´ì§„ì£¼ì™¸êµ­ì–´ê³ ë“±í•™êµ/ë°˜ì„±ì‹œì¥", "ìˆ˜ëª©ì› ë°©ë©´êµ¬ë¦¬/ë°˜ì„±ì‹œì¥", "ìˆ˜ëª©ì› ë°©ë©´ë°˜ì„±ì´ˆë“±í•™êµ/ë‚¨í‰", "ìˆ˜ëª©ì› ë°©ë©´ê°œì•”", "ê²½ìƒë‚¨ë„ìˆ˜ëª©ì›", "ê²½ìƒë‚¨ë„ìˆ˜ëª©ì›ì£¼ì°¨ì¥", "ì–‘ì „", "ë‹µì²œ", "ìƒë‚¨", "ê¸ˆì•¼", "ë‚¨ì‚°", "ë‚¨ì‚°íšŒê´€", "ë‚¨ì˜í™”í•™", "ëŒ€ì‚¬ì…êµ¬", "ë‘ì†ŒíšŒê´€", "ë‘ì†Œ1", "ë‘ì†Œ", "ì¥ê³¡", "ì¥ê³¡ê²½ë¡œë‹¹", "ë‚´ì´Œ", "ìš´ì²œì‚¼ê±°ë¦¬", "ì›ë‹¹", "ë°˜ì„±ì—­", "ìš´ì²œ", "í¬ì‹¤", "ë„ì¥ì…êµ¬", "ì¼ë°˜ì„±ë©´ì‚¬ë¬´ì†Œ", "ë°˜ì„±í„°ë¯¸ë„"],
      "3": ["ë°˜ì„±í„°ë¯¸ë„", "ë°˜ì„±ì¤‘í•™êµ", "ë‹¤ë¬´", "ë‹¤ë¬´ê²½ë¡œíšŒê´€", "ì¤‘ì´Œ", "ì£½í•­", "ì‚¬ë´‰ì‚¼ê±°ë¦¬", "ì§„ì£¼ë™ë¶€ìš”ì–‘ì›", "ë°©ì´Œ", "ë“±ê±´", "ë‚¨ë§ˆì„±ê²½ë¡œíšŒê´€", "ë‚¨ë§ˆì„±", "ì‹œê³¡", "ë¶ë§ˆì„±ê²½ë¡œíšŒê´€", "ë¶ë§ˆì„±", "ëŒ€í•„ë™", "í•„ë™ì‚¼ê±°ë¦¬/ëŒ€í•„ë™", "ì„¸ê³¡", "ì§€ìˆ˜ì´ˆë“±í•™êµ", "ì†¡ì •ì‚¼ê±°ë¦¬", "ì†¡ì •", "ì†Œë¦¬ê³¨", "êµ¬ì ˆ", "ì§€ìˆ˜ì‚¼ê±°ë¦¬/ì§€ìˆ˜ì¤‘í•™êµ", "ì§€ìˆ˜ì‚¼ê±°ë¦¬", "ì§€ìˆ˜ë©´ì‚¬ë¬´ì†Œ", "ì§€ìˆ˜íŒŒì¶œì†Œ", "ë•ì•”", "ë§ˆì‹¤", "ì²­ë‹´ì‚¼ê±°ë¦¬", "ì²­ë‹´", "ë¬´ë“±í•˜ìš°ìŠ¤ë‹¨ì§€", "ë¬´ë“±", "ë¬´ë“±ì¢…ì ", "ë¬´ë“±í•˜ìš°ìŠ¤ë‹¨ì§€", "ì²­ë‹´", "ì²­ë‹´ì‚¼ê±°ë¦¬", "ë§ˆì‹¤", "ë•ì•”", "ì§€ìˆ˜ë©´ì‚¬ë¬´ì†Œ", "ìƒë™", "ì§€ìˆ˜ì‚¼ê±°ë¦¬", "ì²­ì›ì…êµ¬", "í•˜ì´Œ", "ê±°ê³¡ê²½ë¡œíšŒê´€", "ê±°ê³¡", "ë´‰ëŒ€ì‚¼ê±°ë¦¬", "ë´‰ëŒ€", "ì‚¬ë™", "ì‚¬ë´‰ë©´ì‚¬ë¬´ì†Œ/ì‚¬ë´‰ì´ˆë“±í•™êµ", "ìš°ê³¡", "ì§„ë“±", "ì‚¬ë´‰ì‚¼ê±°ë¦¬", "ì£½í•­", "ì¤‘ì´Œ", "ë‹¤ë¬´ê²½ë¡œíšŒê´€", "ë‹¤ë¬´", "ë°˜ì„±ì¤‘í•™êµ", "ë°˜ì„±í„°ë¯¸ë„"],
      "131": ["ì§„ì–‘í˜¸ì°¨ê³ ì§€/ê²½í•´ì—¬ìê³ ë“±í•™êµ", "ì§„ì–‘í˜¸ì‚¼ê±°ë¦¬", "í‰ê±°ì´ˆë“±í•™êµ", "íŒë¬¸í˜„ëŒ€ì•„íŒŒíŠ¸", "í€¸ì¦ˆì›°ê°€ì•„íŒŒíŠ¸", "íŒë¬¸ë™í–‰ì •ë³µì§€ì„¼í„°", "íœ´ë¨¼ì‹œì•„4ë‹¨ì§€/í‰ê±°ì£¼ê³µ2ë‹¨ì§€", "íœ´ë¨¼ì‹œì•„3ë‹¨ì§€/í‰ê±°ì£¼ê³µ1ë‹¨ì§€", "10í˜¸ê´‘ì¥/ë“¤ë§í•œë³´ì•„íŒŒíŠ¸", "ë“¤ë§ëŒ€ê²½ì•„íŒŒíŠ¸", "ì‹ ì•ˆì£¼ê³µì•„íŒŒíŠ¸", "ë²•ì›/í‰ê±°í˜„ëŒ€ì•„íŒŒíŠ¸", "ì‹ ì•ˆì´ˆë“±í•™êµ/ì§„ì£¼ì—¬ìì¤‘í•™êµ", "ì§„ì£¼êµìœ¡ëŒ€í•™êµ", "ì‹ ì•ˆí•™ìƒì²´ìœ¡ê´€", "ì´í˜„ìƒê°€/ë™ì–‘ì£¼íƒ", "ì˜¤ì£½ê´‘ì¥", "ì„œë¶€ë†í˜‘í•˜ë‚˜ë¡œë§ˆíŠ¸", "ì§„ì£¼ë³´ê±´ëŒ€í•™êµ/ê²½ì§„ê³ ë“±í•™êµ", "ìƒë´‰ì•„íŒŒíŠ¸", "ì§„ì£¼ì—¬ìê³ ë“±í•™êµì‚¬ê±°ë¦¬", "ì§„ì£¼ì—¬ìê³ ë“±í•™êµ", "ìƒë´‰í˜„ì¥ë¯¼ì›ì‹¤", "ê°¤ëŸ¬ë¦¬ì•„ë°±í™”ì ", "ì¤‘ì•™ì‹œì¥(ìš°ë¦¬ì€í–‰)", "ë†í˜‘ì¤‘ì•™ì§€ì ", "í¬ì‹œì¦Œ", "ì²œì „ì‹œì¥", "ì§„ì£¼ì„¸ë¬´ì„œ", "ì§„ì£¼ë‚¨ì¤‘í•™êµ/ì œì¼ë³‘ì›", "í•œì£¼ëŸ­í‚¤íƒ€ìš´ì•„íŒŒíŠ¸", "ì„¸ë€ë³‘ì›", "ê¸ˆí˜¸ì„ë¥˜/ì€ë¹›í•œë³´ì•„íŒŒíŠ¸", "ì—°ì•”ê³µê³¼ëŒ€í•™êµ", "ê°€ì¢Œì£¼ê³µì•„íŒŒíŠ¸", "ê°œì–‘ì˜¤ê±°ë¦¬", "ê°€ì¢Œì£¼ê³µ3ë‹¨ì§€", "ì„¼íŠ¸ëŸ´ì›°ê°€ì•„íŒŒíŠ¸", "ì‹œí‹°í”„ë¼ë””ì›€1ì°¨ì•„íŒŒíŠ¸/ë¬´ë“¬ì‚°", "ì§„ì£¼ì—­", "ë°ì‹œì•™", "ì§„ì£¼ì—­ì² ê¸¸ë°‘", "ì£½ë´‰ì…êµ¬", "ìƒˆë™ë„¤", "ê³ ë¯¸ì‚¬ê±°ë¦¬", "ë´‰ë™", "ë‚´ê³„", "ë´‰ì „ì…êµ¬", "ë´‰ì „", "ë´‰ì „ê²½ë¡œíšŒê´€", "ë´‰ì „ì¢…ì "],
      "904": ["ì§„ì£¼ì‹œì™¸í„°ë¯¸ë„", "ì§„ì£¼ì—­", "ì‹œí‹°í”„ë¼ë””ì›€1ì°¨/ë¬´ë“¬ì‚°", "ì‚¬ì²œê³µí•­", "ìš°ì£¼í•­ê³µì²­", "ì‚¬ì²œê³µí•­", "ì§„ì£¼ì—­", "ì§„ì£¼ì‹œì™¸ë²„ìŠ¤í„°ë¯¸ë„"]
    };

    function goTo(pageId) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(pageId).classList.add('active');
    }

    function searchBus() {
      const busNum = document.getElementById('busNumber').value.trim();
      const messageDiv = document.getElementById('searchMessage');
      messageDiv.textContent = '';

      const boardSelect = document.getElementById('boardStation');
      const dropSelect = document.getElementById('dropStation');
      boardSelect.innerHTML = '';
      dropSelect.innerHTML = '';

      if (routes.hasOwnProperty(busNum)) {
        document.getElementById('routeTitle').textContent = `${busNum}ë²ˆ ë²„ìŠ¤ ë…¸ì„ `;
        routes[busNum].forEach(stop => {
          const opt1 = document.createElement('option');
          opt1.value = opt1.textContent = stop;
          boardSelect.appendChild(opt1);

          const opt2 = document.createElement('option');
          opt2.value = opt2.textContent = stop;
          dropSelect.appendChild(opt2);
        });
        goTo('routeView');
      } else {
        messageDiv.textContent = 'í•´ë‹¹ ë²ˆí˜¸ì˜ ë²„ìŠ¤ ë…¸ì„ ì´ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ ì£¼ì„¸ìš”.';
      }
    }

    function generateSeats() {
      const board = document.getElementById('boardStation').value;
      const drop = document.getElementById('dropStation').value;
      if (board === drop) {
        alert('íƒ‘ìŠ¹ ì •ê±°ì¥ê³¼ í•˜ì°¨ ì •ê±°ì¥ì€ ì„œë¡œ ë‹¬ë¼ì•¼ í•©ë‹ˆë‹¤.');
        return;
      }

      const seatMap = document.getElementById('seatMap');
      seatMap.innerHTML = '';
      let occupiedCount = 0;
      for (let i = 1; i <= 20; i++) {
        const seat = document.createElement('div');
        seat.className = 'seat';
        seat.textContent = i;
        const isOccupied = Math.random() < 0.5;
        seat.style.backgroundColor = isOccupied ? 'red' : 'green';
        if (isOccupied) occupiedCount++;
        seatMap.appendChild(seat);
      }

      const remainingStops = Math.floor(Math.random() * 3+1);
      const eta = remainingStops * 3;
      document.getElementById('etaInfo').textContent = `ì˜ˆìƒ ë„ì°© ì‹œê°„: ì•½ ${eta}ë¶„ (${remainingStops} ì •ê±°ì¥ ë‚¨ìŒ)`;

      const congestionRate = occupiedCount / 20;
      const levelText = congestionRate > 0.8 ? 'ë§¤ìš° í˜¼ì¡' : congestionRate > 0.5 ? 'í˜¼ì¡' : 'ì—¬ìœ ';
      const color = congestionRate > 0.8 ? 'red' : congestionRate > 0.5 ? 'orange' : 'green';

      const congestionDiv = document.getElementById('congestionLevel');
      congestionDiv.textContent = `í˜¼ì¡ë„: ${levelText}`;
      congestionDiv.style.color = color;
    }


    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js')
          .then(reg => console.log('Service Worker ë“±ë¡ ì„±ê³µ:', reg.scope))
          .catch(err => console.log('Service Worker ë“±ë¡ ì‹¤íŒ¨:', err));
      });
    }
  </script>
</body>
</html>
